[{"i":"cb441cfd-490c-43e0-91dd-08d20808261f","d":"2010-01-06 00:17:49","u":"anon","n":"Luca Regoli","c":"<b>Php 4.4.4 + PECL impossible? Need to create an exe win service<\/b><br\/>\n<p>Good morning everybody,<\/p>\n<p>  I&#039;m afraid this blog is dead as I didn&#039;t find any other comment after 2005 .. 5 years ago! :(<\/p>\n<p>Anyway I&#039;m using bamcompile a great single EXE compiler for php.. with some limitations..: cannot use php higher than V.4.4.4 and cannot use foreach (array_expression as $key =&gt; $value).<\/p>\n<p>Now, the problem is that I&#039;d like to write a single exe Window Service as my little webcheck php program runs quite well, but is not able to run before user logon.<\/p>\n<p>I thought it was MUCH simpler to create a Win32 Service application but instead I discovered I need a lot more code with no dll support in php 4.4.4.<\/p>\n<p>I tried adding to my PHP4 php.ini installation the <\/p>\n<p>extension=php5ts.dll<\/p>\n<p>extension=php_win32service.dll<\/p>\n<p>as win32service requires php5ts.dll but I get an error as PHP API is different from what expected (of course it is php 4.4.4 instead of 5.2!!)<\/p>\n<p>Now there seems to be a problem that I&#039;m not able to overcome: create a single EXE file which is a windows service with a free php compiler :(<\/p>\n<p>Any ideas??<\/p>\n<p>BTW is there some php 5.x.x chunk of code to create a simple socks service to play with?<\/p>\n<p>I think I&#039;m only missing the PECL::Event to get and answer messages from SCM.<\/p>\n<p>Thanks a lot in advance!<\/p>\n<p>L.R.<\/p>\n<p>Luxnews AT gmail DOT com<\/p>\n<p><\/p>","email":"Luca Regoli","url":null,"did":"51534452"},{"i":"4209e889-d800-3231-9210-209e88941ec1","d":"2005-02-09 10:40:09","u":"anon","n":"giunta.gaetano@sea-aeroportimilano.it","c":"<b>I've been waiting yeras for this<\/b><br\/>\n<p>Now, if only you could port it to PHP 4 too...  <\/p>","email":"giunta.gaetano@sea-aeroportimilano.it","url":null,"did":"51534453"},{"i":"4231cf03-08e6-1914-3687-231cf030fa9b","d":"2005-03-11 17:01:54","u":"anon","n":"Anonymous","c":"<p>Anybody knows how to make it working?? Apache 2 doesn't want to load MODPHP with that extension.  <\/p>","email":"Anonymous","url":null,"did":"51534454"},{"i":"428bdbd9-ac06-9319-5418-28bdbd9df156","d":"2005-05-19 00:20:41","u":"anon","n":"Anonymous","c":"<b>Any real time example<\/b><br\/>\n<p>Is there any real time  sample example to try out here. I wrote a socket server in PHP but that is blocking in nature. How do we run such daemon as a windows service. I am not really windows pro so please ignore my knowledge about windows services.  <\/p>","email":"Anonymous","url":null,"did":"51534455"},{"i":"42b9c10a-fb00-3687-7382-2b9c10a73d74","d":"2005-06-22 19:50:34","u":"anon","n":"gmartinez@accendo-it.com","c":"<b>It did work...but...<\/b><br\/>\n<p>Hi,   <\/p>\n<p>I've just could have a successful script running as a service... So, first of all, great work !   <\/p>\n<p>The one thing that I was not able to do was call a function from within the while() loop.   <\/p>\n<p>I mean;   <\/p>\n<p>while (WIN32_SERVICE_CONTROL_STOP != win32_get_last_control_message()) { ...code... }   <\/p>\n<p>worked fine, but   <\/p>\n<p>while (WIN32_SERVICE_CONTROL_STOP != win32_get_last_control_message()) { my_code($parm); }   <\/p>\n<p>function my_code($parm) { ...code... }   <\/p>\n<p>did not....   <\/p>\n<p>Any ideas ???   <\/p>\n<p>Being able to call my own functions from within the while() loop allows much clearer code (at leas for me :&gt;)   <\/p>\n<p>Look forward to your answer.   <\/p>\n<p>Regards. Gonzalo  <\/p>","email":"gmartinez@accendo-it.com","url":null,"did":"51534456"},{"i":"42b9c505-4184-9504-3372-2b9c50567a16","d":"2005-06-22 20:07:33","u":"anon","n":"gmartinez@accendo-it.com","c":"<b>It did work...no buts at all...<\/b><br\/>\n<p>Previous message was an error of mine, sorry !   <\/p>\n<p>It works just fine !   <\/p>\n<p>Thanks again.  <\/p>","email":"gmartinez@accendo-it.com","url":null,"did":"51534457"},{"i":"42f36ab6-97c5-7896-6842-2f36ab63d19a","d":"2005-08-05 13:33:42","u":"anon","n":"robbie","c":"<b>small mistake<\/b><br\/>\n<p>the sample code still has a small error:   <\/p>\n<p>$x = win32_start_service_ctrl_dispatcher('dummyphp');   <\/p>\n<p>needs to be replaced by: $x = win32_start_service_ctrl_dispatcher('sample dummy PHP service');   <\/p>\n<p>apart from this: great!   <\/p>\n<p>Robbie   <\/p>","email":"robbie","url":null,"did":"51534458"},{"i":"42f3741b-2b5a-2783-0080-2f3741bb7a7c","d":"2005-08-05 14:13:47","u":"anon","n":"robbie","c":"<b>small mistake 2<\/b><br\/>\n<p>add also quotes to: 'params' =&gt; '&quot;'. <i><\/i>FILE_<i> . '&quot;' . ' run', <\/i>  <\/p>\n<p>this is for when you run your sript from a directory which contains spaces like fe &quot;Program Files&quot;   <\/p>\n<p>this error and previous one is applicable for win xp, on win 2003 the example is working fine without these modifications and also with these modifications ;-)   <\/p>\n<p>Robbie  <\/p>","email":"robbie","url":null,"did":"51534459"},{"i":"430a89de-412a-1584-1575-30a89de382da","d":"2005-08-23 02:28:46","u":"anon","n":"gmartinez@accendo-it.com","c":"<b>Problem running under Windows XP<\/b><br\/>\n<p>Hi,   <\/p>\n<p>I had my php script running as a service perfectly under Win2k.   <\/p>\n<p>Now, I've installed WinXP, and the service do not start.   <\/p>\n<p>In the event viewer I get;   <\/p>\n<p>&quot;... Timeout (30000 milliseconds) waiting for the MY SERVICE service to connect.   <\/p>\n<p>For more information, see Help and Support Center at http:\/\/go.microsoft.com\/fwlink\/events.asp. ...&quot;   <\/p>\n<p>Any Ideas ???  <\/p>","email":"gmartinez@accendo-it.com","url":null,"did":"51534460"},{"i":"430db495-ee05-9189-4449-30db4958181b","d":"2005-08-25 12:07:49","u":"anon","n":"gmartinez@accendo-it.com","c":"<b>Problem running under Windows XP<\/b><br\/>\n<p>I got it working now.   <\/p>\n<p>It works fine  <\/p>","email":"gmartinez@accendo-it.com","url":null,"did":"51534463"},{"i":"43565ecf-c326-3148-0797-3565ecf10465","d":"2005-10-19 14:57:19","u":"anon","n":"smitchell@northrock.bm","c":"<b>Using PECL::Event to check service stopage<\/b><br\/>\n<p>Has anyone used the PECL::Event to check for the control_stop? I've almost got it but I can't seem to get it to run my stopage code when I stop the service.   <\/p>\n<p>Here is what I have right now:   <\/p>\n<p>$x = win32_start_service_ctrl_dispatcher('WWH');   <\/p>\n<p>function check_service(){ if(WIN32_SERVICE_CONTROL_STOP == win32_get_last_control_message()){ stop(); exit; } }   <\/p>\n<p>event_init(); $e = event_new(NULL, EV_PERSIST, 'check_service'); event_schedule($e, 2, 0); event_dispatch();   <\/p>\n<p>.. More code like the stop function.   <\/p>\n<p>Thanks  <\/p>","email":"smitchell@northrock.bm","url":null,"did":"51534464"},{"i":"4356e01f-2ac2-1810-2432-356e01fa7680","d":"2005-10-20 00:09:03","u":"anon","n":"smitchell@northrock.bm","c":"<b>Quick note PECL::Event<\/b><br\/>\n<p>After looking at the CVS for PECL::Event I found the even_timout method that works better for me as I'm not using streams. What I'm finding now is that anything after me event_dispatch() is not be run.   <\/p>\n<p>I'm trying to use this with a socket server but I'm trying to use the current version on the socket server and not replacing it with the Event methods. I just want Event to run the check for closure method every X time.   <\/p>\n<p>Lastly, I've noticed that since my socket server waits in a loop that I wasn't able to put the service control in the same code that created the server as it never ran anything after the server was opened because it didn't return but waited for connections.  <\/p>","email":"smitchell@northrock.bm","url":null,"did":"51534465"}]